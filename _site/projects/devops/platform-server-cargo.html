<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
  <meta name="baidu-site-verification" content="B786jeR0MV" />
  <meta name="msvalidate.01" content="29F791E7F785800340E37AD7C714D2A7" />
  <meta name="google-site-verification" content="p7jJ5d3kF9yxRhpIo5GgHXAZ1ATKVyZhV2kf6mEGOv0" />
  <title>Cargo 实现|JinYang's Blog</title>
  <meta name="keywords" content="">
  <meta name="description" content="">

  <script src="https://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
  <script type="text/javascript">
  !window.jQuery && document.write('<script src="/static/js/jquery.min.js"><\/script>');
  </script>
  <script src="https://cdn.bootcss.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
  <script type="text/javascript">
  !$('body').popover && document.write('<script src="/static/js/bootstrap.min.js"><\/script>');
  </script>
  <script type="text/javascript" src="/static/js/main.js"></script>
  <!-- <link rel="stylesheet prefetch" href="http://cdn.bootcss.com/bootstrap/3.3.0/css/bootstrap.min.css"> -->
  <link type="text/css" rel="stylesheet prefetch" href="/static/css/bootstrap.min.css">
  <!-- <link href="http://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"> -->
  <link type="text/css" rel="stylesheet prefetch" href="/static/css/font-awesome.min.css">
  <link type="text/css" rel="stylesheet prefetch" href="/static/css/pygments.css">
  <link type="text/css" rel="stylesheet prefetch" href="/static/css/screen.css">
  <style type="text/css">
  
    .post-container > p {text-indent: 2em;}
  
  </style>
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-124556620-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-124556620-1');
</script>

</head>

<body>
<nav class="navbar navbar-default navbar-inverse navbar-fixed-top navbar-wrapper">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
      </button><a class="navbar-brand" href="/">Jin-Yang</a>
    </div>
    <div id="navbar" class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        <li  ><a href="/"> Home </a></li>
        <li  ><a href="/archives.html"> Archive </a></li>
        <li  ><a href="/categories.html"> Categories </a></li>
        <li  ><a href="/projects.html"> Projects </a></li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"> Others <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li class="dropdown-header">常用网站</li>
            <li role="separator" class="divider"></li>
            <li><a href="https://www.rtems.org/">www.rtems.org</a></li>
            <li><a href="http://www.gnu.org/">www.gnu.org</a></li>
            <li><a href="https://www.kernel.org/">www.kernel.org</a></li>
            <li><a href="https://www.arduino.cc/">www.arduino.cc</a></li>
          </ul>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li  ><a href="/about.html"> About </a></li>
      </ul>
    </div><!--/.nav-collapse -->
  </div>
</nav>

<div id="myCarousel" class="carousel slide" data-ride="carousel">
  <!-- Indicators -->
  <ol class="carousel-indicators">
    <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
    <li data-target="#myCarousel" data-slide-to="1"></li>
    <li data-target="#myCarousel" data-slide-to="2"></li>
    <li data-target="#myCarousel" data-slide-to="3"></li>
    <li data-target="#myCarousel" data-slide-to="4"></li>
  </ol>
  <div class="carousel-inner" role="listbox">
    <div class="item active">
      <img src="data:image/gif;base64,R0lGODlhAQABAIAAAGZmZgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="Second slide">
      <div class="container">
        <div class="carousel-caption">
          <h1>KISS</h1>
          <h2>Keep It Simple and Stupid.</h2>
          <!--<a class="btn btn-lg btn-primary" href="#" role="button">Sign up today</a>-->
        </div>
      </div>
    </div>
    <div class="item">
      <img src="data:image/gif;base64,R0lGODlhAQABAIAAAGZmZgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="Second slide">
      <div class="container">
        <div class="carousel-caption">
          <h1>Seize The Day</h1><h1>And Get Busy Living</h1>
        </div>
      </div>
    </div>
    <div class="item">
      <img src="data:image/gif;base64,R0lGODlhAQABAIAAAGZmZgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="Second slide">
      <div class="container">
        <div class="carousel-caption">
          <h1>Stay hungry</h1><h1>Stay foolish</h1>
        </div>
      </div>
    </div>
    <div class="item">
      <img src="data:image/gif;base64,R0lGODlhAQABAIAAAGZmZgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="Second slide">
      <div class="container">
        <div class="carousel-caption">
	  <h2>Ever tried, ever failed</h2><h2>No matter, try again</h2><h2>Fail again, fail better</h2>
        </div>
      </div>
    </div>
    <div class="item">
      <img src="data:image/gif;base64,R0lGODlhAQABAIAAAGZmZgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="Second slide">
      <div class="container">
        <div class="carousel-caption">
          <h1>Nothing is true</h1><h1>Every is permitted</h1>
        </div>
      </div>
    </div>
  </div>
  <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
    <span class="glyphicon glyphicon-chevron-left"></span>
    <span class="sr-only">Previous</span>
  </a>
  <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
    <span class="glyphicon glyphicon-chevron-right"></span>
    <span class="sr-only">Next</span>
  </a>
</div><!-- /.carousel -->

<div class="container">
  <div class="row">
    <div class="col-lg-12 blog-main" style="min-width: 500px">
      <div class="post-container">
        <div class="blog-header">
          <h1>Cargo 实现</h1>
        </div>
        <hr>
        <p>DevOps 工具的单点登陆与用户管理系统。</p>

<h2 id="restful-api">RESTFul API</h2>

<figure class="highlight"><pre><code class="language-text" data-lang="text">----- POST /api/v1/login  登陆
{
	&quot;username&quot;: &quot;your name&quot;,      用户名
	&quot;password&quot;: &quot;your password&quot;,  密码
	&quot;type&quot;: &quot;account&quot;,            登陆方式account(帐号)
}

----- GET  /api/v1/user/current  获取当前用户信息
{
	&quot;id&quot;:&quot;00000001&quot;,
	&quot;name&quot;:&quot;Andy Dufresne&quot;,
	&quot;phone&quot;:&quot;0752-268888888&quot;
	&quot;avatar&quot;:&quot;https://gw.alipayobjects.com/zos/rmsportal/BiazfanxmamNRoxxVxka.png&quot;,
	&quot;email&quot;:&quot;antdesign@alipay.com&quot;,
	&quot;signature&quot;:&quot;海纳百川，有容乃大&quot;,
	&quot;title&quot;:&quot;高级SRE&quot;,
	&quot;group&quot;:&quot;某某某事业群－某某平台部－某某技术部－SRE&quot;,
	&quot;country&quot;: &quot;China&quot;,
	&quot;geographic&quot;: {
		&quot;province&quot;: {
			&quot;key&quot;:&quot;330000&quot;
			&quot;label&quot;:&quot;浙江省&quot;,
		},
		&quot;city&quot;:  {
			&quot;key&quot;:&quot;330100&quot;
			&quot;label&quot;:&quot;杭州市&quot;,
		}
	},
	&quot;address&quot;:&quot;西湖区工专路 77 号&quot;,
	&quot;notifyCount&quot;:12,
}

----- POST /api/v1/register  注册用户
{
	&quot;type&quot;: &quot;account&quot;,                 # 可选
	&quot;name&quot;: &quot;Foo Bar&quot;,                 # 必选，登陆用户名
	&quot;password&quot;: &quot;Your PassWord&quot;,       # 必选，登陆密码
}

----- GET  /api/v1/sso/user?name=FooBar 用户信息查询
{
	&quot;name&quot;: &quot;Foo Bar&quot;,                 # 用户名
	&quot;roles&quot;: [ &quot;admin&quot;, &quot;readonly&quot; ]   # 用户角色
}</code></pre></figure>

<p>如果 POST 请求中不包含用户名密码，但是 JWT-Cookie 是合法的，那么会自动刷新。</p>

<h2 id="表结构">表结构</h2>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="o">`</span><span class="n">SSO</span><span class="o">`</span><span class="p">;</span>
<span class="n">USE</span> <span class="o">`</span><span class="n">SSO</span><span class="o">`</span><span class="p">;</span>

<span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">EXISTS</span> <span class="o">`</span><span class="n">users</span><span class="o">`</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="o">`</span><span class="n">users</span><span class="o">`</span> <span class="p">(</span>
	<span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="nb">INT</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
	<span class="o">`</span><span class="n">userid</span><span class="o">`</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="ss">&quot;登陆用户名，内部使用ID&quot;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">name</span><span class="o">`</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="ss">&quot;用户名&quot;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">phone</span><span class="o">`</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="k">COMMENT</span> <span class="ss">&quot;手机号，密保验证手机&quot;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">avatar</span><span class="o">`</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span> <span class="k">COMMENT</span> <span class="ss">&quot;头像地址&quot;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">email</span><span class="o">`</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="k">COMMENT</span> <span class="ss">&quot;邮箱地址&quot;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">password</span><span class="o">`</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">2048</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="ss">&quot;密码，加密之后&quot;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">signature</span><span class="o">`</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span> <span class="k">COMMENT</span> <span class="ss">&quot;个人签名&quot;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">title</span><span class="o">`</span> <span class="nb">INT</span> <span class="k">COMMENT</span> <span class="ss">&quot;职级名称，例如高级SRE&quot;</span><span class="p">,</span>
	<span class="o">`</span><span class="k">group</span><span class="o">`</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span> <span class="k">COMMENT</span> <span class="ss">&quot;公司内部门名称&quot;</span><span class="p">,</span>

	<span class="o">`</span><span class="n">contry</span><span class="o">`</span> <span class="nb">INT</span> <span class="k">COMMENT</span> <span class="ss">&quot;国家/地区&quot;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">province</span><span class="o">`</span> <span class="nb">INT</span> <span class="k">COMMENT</span> <span class="ss">&quot;所在省&quot;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">city</span><span class="o">`</span> <span class="nb">INT</span> <span class="k">COMMENT</span> <span class="ss">&quot;所在市&quot;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">address</span><span class="o">`</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span> <span class="k">COMMENT</span> <span class="ss">&quot;详细地址&quot;</span><span class="p">,</span>

	<span class="o">`</span><span class="n">notifycnt</span><span class="o">`</span> <span class="nb">INT</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">DEFAULT</span> <span class="mi">0</span> <span class="k">COMMENT</span> <span class="ss">&quot;用户收到的消息数&quot;</span><span class="p">,</span>

	<span class="o">`</span><span class="n">status</span><span class="o">`</span> <span class="nb">INT</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">DEFAULT</span> <span class="mi">0</span> <span class="k">COMMENT</span> <span class="ss">&quot;用户状态 0: INIT&quot;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">pwdscore</span><span class="o">`</span> <span class="nb">INT</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">DEFAULT</span> <span class="mi">0</span> <span class="k">COMMENT</span> <span class="ss">&quot;密码强度，自动计算，0~100&quot;</span><span class="p">,</span>
	<span class="o">`</span><span class="k">security</span><span class="o">`</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span> <span class="k">COMMENT</span> <span class="ss">&quot;密保问题，同时会非对称加密&quot;</span><span class="p">,</span>

	<span class="o">`</span><span class="n">notice</span><span class="o">`</span> <span class="nb">INT</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">DEFAULT</span> <span class="mi">0</span> <span class="k">COMMENT</span> <span class="ss">&quot;消息通知方式，位与方式&quot;</span><span class="p">,</span>

	<span class="o">`</span><span class="n">gmt_modify</span><span class="o">`</span> <span class="k">TIMESTAMP</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">ON</span> <span class="k">UPDATE</span> <span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
	<span class="o">`</span><span class="n">gmt_create</span><span class="o">`</span> <span class="k">TIMESTAMP</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">DEFAULT</span> <span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
	<span class="k">UNIQUE</span> <span class="k">KEY</span> <span class="o">`</span><span class="n">uk_uid</span><span class="o">`</span> <span class="p">(</span><span class="o">`</span><span class="n">userid</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8mb4</span> <span class="k">COMMENT</span> <span class="ss">&quot;用户信息&quot;</span><span class="p">;</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">users</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">userid</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="ss">&quot;root&quot;</span><span class="p">,</span> <span class="ss">&quot;root&quot;</span><span class="p">,</span> <span class="ss">&quot;Unsecure Password&quot;</span><span class="p">);</span>

<span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">EXISTS</span> <span class="o">`</span><span class="n">addrinfo</span><span class="o">`</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="o">`</span><span class="n">addrinfo</span><span class="o">`</span> <span class="p">(</span>
	<span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="nb">INT</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
	<span class="o">`</span><span class="n">name</span><span class="o">`</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="ss">&quot;名称&quot;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">gmt_modify</span><span class="o">`</span> <span class="k">TIMESTAMP</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">ON</span> <span class="k">UPDATE</span> <span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
	<span class="o">`</span><span class="n">gmt_create</span><span class="o">`</span> <span class="k">TIMESTAMP</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">DEFAULT</span> <span class="k">CURRENT_TIMESTAMP</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8mb4</span> <span class="k">COMMENT</span> <span class="ss">&quot;地址信息，自动会初始化&quot;</span><span class="p">;</span>

<span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">EXISTS</span> <span class="o">`</span><span class="n">roles</span><span class="o">`</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="o">`</span><span class="n">roles</span><span class="o">`</span> <span class="p">(</span>
	<span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="nb">INT</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
	<span class="o">`</span><span class="n">name</span><span class="o">`</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="ss">&quot;角色名称，尽量短，会保存到Token中&quot;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">description</span><span class="o">`</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span> <span class="k">COMMENT</span> <span class="ss">&quot;角色描述&quot;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">gmt_modify</span><span class="o">`</span> <span class="k">TIMESTAMP</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">ON</span> <span class="k">UPDATE</span> <span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
	<span class="o">`</span><span class="n">gmt_create</span><span class="o">`</span> <span class="k">TIMESTAMP</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">DEFAULT</span> <span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
	<span class="k">UNIQUE</span> <span class="k">KEY</span> <span class="o">`</span><span class="n">uk_name</span><span class="o">`</span> <span class="p">(</span><span class="o">`</span><span class="n">name</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8mb4</span> <span class="k">COMMENT</span> <span class="ss">&quot;服务端下发的任务&quot;</span><span class="p">;</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">roles</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="ss">&quot;readonly&quot;</span><span class="p">,</span> <span class="ss">&quot;只读账户&quot;</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">roles</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="ss">&quot;admin&quot;</span><span class="p">,</span> <span class="ss">&quot;管理员&quot;</span><span class="p">);</span>

<span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">EXISTS</span> <span class="o">`</span><span class="n">users_roles</span><span class="o">`</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">IF</span> <span class="k">NOT</span> <span class="k">EXISTS</span> <span class="o">`</span><span class="n">users_roles</span><span class="o">`</span> <span class="p">(</span>
	<span class="o">`</span><span class="n">userid</span><span class="o">`</span> <span class="nb">INT</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="ss">&quot;用户ID信息&quot;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">roleid</span><span class="o">`</span> <span class="nb">INT</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">COMMENT</span> <span class="ss">&quot;角色ID信息&quot;</span><span class="p">,</span>
	<span class="o">`</span><span class="n">gmt_modify</span><span class="o">`</span> <span class="k">TIMESTAMP</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">ON</span> <span class="k">UPDATE</span> <span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
	<span class="o">`</span><span class="n">gmt_create</span><span class="o">`</span> <span class="k">TIMESTAMP</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">DEFAULT</span> <span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
	<span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">userid</span><span class="p">,</span> <span class="n">roleid</span><span class="p">)</span>
<span class="p">)</span> <span class="n">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="n">CHARSET</span><span class="o">=</span><span class="n">utf8mb4</span> <span class="k">COMMENT</span> <span class="ss">&quot;用户和角色的关联表&quot;</span><span class="p">;</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">users_roles</span><span class="p">(</span><span class="n">userid</span><span class="p">,</span> <span class="n">roleid</span><span class="p">)</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span></code></pre></figure>

<!--
中国行政区划信息
https://github.com/mumuy/data_location
https://github.com/modood/Administrative-divisions-of-China

echo统一错误处理
https://zhuanlan.zhihu.com/p/26300634
-->


        <hr>
      </div>
    </div>
  </div>
  <hr><p class="text-center">This Site was built by Jin Yang, generated with Jekyll, and hosted on GitHub Pages<br/> &copy;2013-2019 &ndash; Jin Yang</p><div class="footer-logo"></div>

</div>
</body>
</html>
