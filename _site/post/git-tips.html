<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
  <meta name="baidu-site-verification" content="B786jeR0MV" />
  <meta name="msvalidate.01" content="29F791E7F785800340E37AD7C714D2A7" />
  <meta name="google-site-verification" content="p7jJ5d3kF9yxRhpIo5GgHXAZ1ATKVyZhV2kf6mEGOv0" />
  <title>Git 使用杂项|JinYang's Blog</title>
  <meta name="keywords" content="git,示例">
  <meta name="description" content="记录 git 常见的示例，可以用来作为参考使用。">

  <script src="https://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
  <script type="text/javascript">
  !window.jQuery && document.write('<script src="/static/js/jquery.min.js"><\/script>');
  </script>
  <script src="https://cdn.bootcss.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
  <script type="text/javascript">
  !$('body').popover && document.write('<script src="/static/js/bootstrap.min.js"><\/script>');
  </script>
  <script type="text/javascript" src="/static/js/main.js"></script>
  <!-- <link rel="stylesheet prefetch" href="http://cdn.bootcss.com/bootstrap/3.3.0/css/bootstrap.min.css"> -->
  <link type="text/css" rel="stylesheet prefetch" href="/static/css/bootstrap.min.css">
  <!-- <link href="http://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"> -->
  <link type="text/css" rel="stylesheet prefetch" href="/static/css/font-awesome.min.css">
  <link type="text/css" rel="stylesheet prefetch" href="/static/css/pygments.css">
  <link type="text/css" rel="stylesheet prefetch" href="/static/css/screen.css">
  <style type="text/css">
  
    .post-container > p {text-indent: 2em;}
  
  </style>
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-124556620-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-124556620-1');
</script>

</head>

<body>
<nav class="navbar navbar-default navbar-inverse navbar-fixed-top navbar-wrapper">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
      </button><a class="navbar-brand" href="/">Jin-Yang</a>
    </div>
    <div id="navbar" class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        <li  ><a href="/"> Home </a></li>
        <li  ><a href="/archives.html"> Archive </a></li>
        <li  ><a href="/categories.html"> Categories </a></li>
        <li  ><a href="/projects.html"> Projects </a></li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"> Others <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li class="dropdown-header">常用网站</li>
            <li role="separator" class="divider"></li>
            <li><a href="https://www.rtems.org/">www.rtems.org</a></li>
            <li><a href="http://www.gnu.org/">www.gnu.org</a></li>
            <li><a href="https://www.kernel.org/">www.kernel.org</a></li>
            <li><a href="https://www.arduino.cc/">www.arduino.cc</a></li>
          </ul>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li  ><a href="/about.html"> About </a></li>
      </ul>
    </div><!--/.nav-collapse -->
  </div>
</nav>

<div id="myCarousel" class="carousel slide" data-ride="carousel">
  <!-- Indicators -->
  <ol class="carousel-indicators">
    <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
    <li data-target="#myCarousel" data-slide-to="1"></li>
    <li data-target="#myCarousel" data-slide-to="2"></li>
    <li data-target="#myCarousel" data-slide-to="3"></li>
    <li data-target="#myCarousel" data-slide-to="4"></li>
  </ol>
  <div class="carousel-inner" role="listbox">
    <div class="item active">
      <img src="data:image/gif;base64,R0lGODlhAQABAIAAAGZmZgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="Second slide">
      <div class="container">
        <div class="carousel-caption">
          <h1>KISS</h1>
          <h2>Keep It Simple and Stupid.</h2>
          <!--<a class="btn btn-lg btn-primary" href="#" role="button">Sign up today</a>-->
        </div>
      </div>
    </div>
    <div class="item">
      <img src="data:image/gif;base64,R0lGODlhAQABAIAAAGZmZgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="Second slide">
      <div class="container">
        <div class="carousel-caption">
          <h1>Seize The Day</h1><h1>And Get Busy Living</h1>
        </div>
      </div>
    </div>
    <div class="item">
      <img src="data:image/gif;base64,R0lGODlhAQABAIAAAGZmZgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="Second slide">
      <div class="container">
        <div class="carousel-caption">
          <h1>Stay hungry</h1><h1>Stay foolish</h1>
        </div>
      </div>
    </div>
    <div class="item">
      <img src="data:image/gif;base64,R0lGODlhAQABAIAAAGZmZgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="Second slide">
      <div class="container">
        <div class="carousel-caption">
	  <h2>Ever tried, ever failed</h2><h2>No matter, try again</h2><h2>Fail again, fail better</h2>
        </div>
      </div>
    </div>
    <div class="item">
      <img src="data:image/gif;base64,R0lGODlhAQABAIAAAGZmZgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="Second slide">
      <div class="container">
        <div class="carousel-caption">
          <h1>Nothing is true</h1><h1>Every is permitted</h1>
        </div>
      </div>
    </div>
  </div>
  <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
    <span class="glyphicon glyphicon-chevron-left"></span>
    <span class="sr-only">Previous</span>
  </a>
  <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
    <span class="glyphicon glyphicon-chevron-right"></span>
    <span class="sr-only">Next</span>
  </a>
</div><!-- /.carousel -->

<div class="container">
  <div class="row">
    <div class="col-lg-9 blog-main" style="min-width: 500px">
    
<div class="post-container">
  <div class="blog-header">
    <h1>Git 使用杂项</h1>
    <div class="post-description">
      <i class="fa fa-calendar"></i> 2015-09-10 Thursday &nbsp; &nbsp;
      <i class="fa fa-tags"></i>  linux ,  misc  
      
    </div>
  </div>
  <hr>
  <p>记录 git 常见的示例，可以用来作为参考使用。</p>

<!-- more -->

<!--
顺手把别的项目翻出来看，也有很实用的工具，比如git-review。

git-review为git新增了一个很方便的代码review途径，利用这个命令，可以调用别的工具比如vimdiff来review代码的改动。下面简单记录一下使用的过程：
下载并安装

首先确认已经装好了git，剩下的事情比较简单。


git clone git://github.com/facebook/git-review.git
cd git-review
python setup.py install

这几步为git新增了一个review命令。
git-review的使用
查看指定版本的改动


git review 58e2fb834793f5c6c1fdd900a1c0224a44735962

出现提示

    Now processing modified file foo.php
    foo.php [diff]>

由于我配置了diff工具为vimdiff，所以接下来就可以用vimdiff查看foo.php在58e2fb834793f5c6c1fdd900a1c0224a44735962这个版本与最新版本之间有什么不同。
查看两个版本之间的改动


git review 5b744bdc5f5bcbcfd6bb65f815aebe6bdce8c427 58e2fb834793f5c6c1fdd900a1c0224a44735962

在review每个代码之前，都可以使用help查看git review命令的帮助，如果放弃review，那么直接敲退出就可以了。

https://github.com/openstack-infra/git-review
https://pypi.python.org/pypi/git-review
-->

<h2 id="tag-管理">TAG 管理</h2>

<p>一般可以通过 <code>git describe</code> 显示离当前提交最近的 TAG 信息，如果最近有提交为 TAG，则只显示 TAG 信息，否则会有相关的后缀来描述该 TAG 后有多少次提交，以及最新的 CommitID 。</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">v1.0.0-rc1-10-g0c2b1cf
  v1.0.0-rc 表示TAG的信息
  10 表示自从打了v1.0.0-rc1之后又有10提交
  g0c2b1cf g为git缩写，用于区分多个版本管理工具；0c2b1cf表示最新提交的CommitID</code></pre></figure>

<p>当知道了该信息后，如果要检查某个版本的问题，可以直接通过 <code>git checkout 0c2b1cf</code> 切换到对应的代码。</p>

<h3 id="多分支管理">多分支管理</h3>

<p>首先，TAG 信息是全局的，但是不同的分支可以分别通过 <code>git describe</code> 显示版本信息。例如，在开源开发时有内部版本和开源版本，那么就可以通两个分支进行管理，分别打 TAG 信息。</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">$ git init
$ echo &quot;Version 1&quot; &gt; README.md
$ git add -A .
$ git commit -m &quot;Version 1.0&quot;
$ git tag -a v1.0 -m &#39;Version 1.0&#39;

$ git checkout -b master-os
$ echo &quot;Version 2&quot; &gt; README.md
$ git add -A .
$ git commit -m &quot;Version 2.0&quot;
$ git tag -a v2.0 -m &#39;Version 2.0&#39;

$ git describe --match &quot;v[0-9]*&quot; --abbrev=5 HEAD 2&gt;/dev/null</code></pre></figure>

<h3 id="其它">其它</h3>

<p>注意，如果要使用 <code>describe</code> 功能，需要使用 <code>Annotated Tags</code> ，否则会报错，命令行中可以通过如下命令执行。</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">$ git tag -a v1.4 -m &quot;version 1.4&quot;</code></pre></figure>

<h2 id="免登陆">免登陆</h2>

<p>对于不同的 git 版本，可以有如下的几种设置方式。</p>

<!--
http://stackoverflow.com/questions/5343068/is-there-a-way-to-skip-password-typing-when-using-https-on-github/5343146#5343146
-->
<h3 id="http">http</h3>

<h4 id="v179-later">v1.7.9 later</h4>

<p>git-v1.7.9 之后的版本，对于 HTTP(S) 链接方式，可以通过 <a href="https://www.kernel.org/pub/software/scm/git/docs/v1.7.9/gitcredentials.html">Credential Helpers</a> 实现免登陆，可以通过如下方式配置。</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">----- 直接缓存在内存中
$ git config --global credential.helper cache

----- 默认过期时间为15min，可以通过如下方式设置为1hour
$ git config --global credential.helper &quot;cache --timeout=3600&quot;</code></pre></figure>

<p>除了 cache 之外，还可以用各个平台上的 keyring 工具，例如 MacOS (osxkeychain)、Windows (wincred)、Linux (gnome-keyring) 等。</p>

<h4 id="v179-before">v1.7.9 before</h4>

<p>对于 v1.7.9 之前版本，可以设置配置文件中的 origin URL，将其配置为如下内容。</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">https://you:password@github.com/you/example.git</code></pre></figure>

<p>当然，也可以通过如下命令进行配置。</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">$ git config remote.origin.url https://you:password@github.com/you/example.git</code></pre></figure>

<p>不过这种方式的 <strong>密码是明文保存的</strong>，其安全性显而易见。</p>

<h4 id="netrc">netrc</h4>

<p>这个是通用的方式，不过也是明文保存密码。</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">$ chmod 600 ~/.netrc
$ cat ~/.netrc
machine &lt;hostname&gt; login &lt;username&gt; password &lt;password&gt;</code></pre></figure>

<p>对于 Windows 则文件要命名为 <code>_netrc</code>，同时设置好 <code>%HOME%</code> 环境变量。</p>

<h3 id="ssh">ssh</h3>

<p>首先设置全局配置。</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">$ git config --global user.name &quot;foobar hello&quot;
$ git config --global user.email &quot;foobar@kidding.com&quot;</code></pre></figure>

<h4 id="ssh-模式免登陆配置">SSH 模式免登陆配置</h4>

<p>注意: <strong>一定要保护好私钥文件</strong>。</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">$ ssh-keygen -t rsa -N &quot;&quot; -f ~/.ssh/git_id -C &quot;foobar@example.com&quot;
$ cat &lt;&lt; EOF &gt;&gt; ~/.ssh/config
# 添加的是git@之后的域名
Host gitlab.com
    User foobar
    Identityfile ~/.ssh/git_id
EOF</code></pre></figure>

<p>然后在 gitlab 的个人 Profile 中，也就是 <code>Profile Setting=&gt;SSH Kyes</code>，添加上述生成的公钥，通过如下方式测试。</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">$ ssh -T git@gitlab.com
Welcome to GitLab, foobar hello!</code></pre></figure>

<p>如果使用非标准 <code>22</code> 端口，那么需要通过 <code>-p PORT</code> 参数指定，而非使用 <code>your.host.com:PORT</code> 这种方式。</p>

<p>注意：配置文件中同样也需要通过 <code>Port PORT</code> 参数指定。</p>

<h2 id="修改已提交-commit">修改已提交 commit</h2>

<p>经常会遇到一些不希望的提交，例如误添加了密码，所以就会有增删改某次或某些提交的需求，这里简单收集下修改本地和远程版本历史的一些方法。</p>

<!--
https://github.com/uolcano/blog/issues/12
### 本地修改
    修改最近一次的commit

    修改提交的描述

    git commit --amend

    然后会进入一个文本编辑器界面，修改commit的描述内容，即可完成操作。

    修改提交的文件

    git add <filename> # 或者 git rm
    git commit --amend # 将缓存区的内容做为最近一次提交

    修改任意提交历史位置的commit

    可以通过变基命令，修改最近一次提交以前的某次提交。不过修改的提交到当前提交之间的所有提交的hash值都会改变。
    变基操作需要非常小心，一定要多用git status命令来查看你是否还处于变基操作，可能某次误操作的会对后面的提交历史造成很大影响。

    首先查看提交日志，以便变基后，确认提交历史的修改

    git log

    变基操作。 可以用commit~n或commit^^这种形式替代：前者表示当前提交到n次以前的提交，后者^符号越多表示的范围越大，commit可以是HEAD或者某次提交的hash值；-i参数表示进入交互模式。

    git rebase -i <commit range>

    以上变基命令会进入文本编辑器，其中每一行就是某次提交，把pick修改为edit，保存退出该文本编辑器。

    **注意：**变基命令打开的文本编辑器中的commit顺序跟git log查看的顺序是相反的，也就是最近的提交在下面，老旧的提交在上面

    **注意：**变基命令其实可以同时对多个提交进行修改，只需要修改将对应行前的pick都修改为edit，保存退出后会根据你修改的数目多次打开修改某次commit的文本编辑器界面。但是这个范围内的最终祖先commit不能修改，也就是如果有5行commit信息，你只能修改下面4行的，这不仅限于commit修改，重排、删除以及合并都如此。

    git commit --amend

    接下来修改提交描述内容或者文件内容，跟最近一次的commit的操作相同，不赘述。

    然后完成变基操作

    git rebase --continue

    有时候会完成变基失败，需要git add --all才能解决，一般git会给出提示。

    再次查看提交日志，对比变基前后的修改，可以看到的内的所有提交的hash值都被修改了

    git log

    如果过了一段时间后，你发现这次历史修改有误，想退回去怎么办？请往下继续阅读

    重排或删除某些提交

    变基命令非常强大，还可以将提交历史重新手动排序或者删除某次提交。这为某些误操作，导致不希望公开信息的提交，提供了补救措施

    git rebase -i <commit range>

    如前面描述，这会进入文本编辑器，对某行提交进行排序或者删除，保存退出。可以是多行修改。

    后续操作同上。

    合并多次提交

    非关键性的提交太多会让版本历史很难看、冗余，所以合并多次提交也是挺有必要的。同样是使用以上的变基命令，不同的是变基命令打开的文本编辑器里的内容的修改。

    将pick修改为squash，可以是多行修改，然后保存退出。这个操作会将标记为squash的所有提交，都合并到最近的一个祖先提交上。

    **注意：**不能对的第一行commit进行修改，至少保证第一行是接受合并的祖先提交。

    后续操作同上。

    分离某次提交

    变基命令还能分离提交，这里不描述，详情查看后面的参考链接

    终极手段

    git还提供了修改版本历史的“大杀器”——filter-branch，可以对整个版本历史中的每次提交进行修改，可用于删除误操作提交的密码等敏感信息。

    删除所有提交中的某个文件

    git filter-branch --treefilter 'rm -f password.txt' HEAD

    将新建的主目录作为所有提交的根目录

    git filter-branch --subdirectory-filter trunk HEAD

本地回退

回退操作也是对过往提交的一剂“后悔药”，常用的回退方式有三种：checkout、reset和revert

    checkout

    对单个文件进行回退。不会修改当前的HEAD指针的位置，也就是提交并未回退

    可以是某次提交的hash值，或者HEAD（缺省即默认）

    git checkout <commit> -- <filename>

    reset

    回退到某次提交。回退到的指定提交以后的提交都会从提交日志上消失
    **注意：**工作区和暂存区的内容都会被重置到指定提交的时候，如果不加--hard则只移动HEAD的指针，不影响工作区和暂存区的内容。

    git reset --hard <commit>

    结合git reflog找回提交日志上看不到的版本历史，撤回某次操作前的状态

    git reflog # 找到某次操作前的提交hash值
    git reset <commit>

    这个方法可以对你的回退操作进行回退，因为这时候git log命令已经找不到历史提交的hash值了。

    revert

    这个方法是最温和，最受推荐的，因为本质上不是修改过去的版本历史，而是将回退版本历史作为一次新的提交，所以不会改变版本历史，在push到远程仓库的时候也不会影响到团队其他人。

    git revert <commit>

远程修改

对远程仓库的版本历史修改，都是在本地修改的基础上进行的：本地修改完成后，再push到远程仓库。

但是除了git revert可以直接push，其他都会对原有的版本历史修改，只能使用强制push

git push -f <remote> <branch>

总结

git commit --amend改写单次commit
git rebase -i <commit range>删改排以及合并多个commit
git checkout <commit> -- <filename>获取历史版本的某个文件
git reset [--hard] <commit>移动HEAD指针
git revert <commit>创建一个回退提交
git push -f <remote> <branch>强制push，覆盖原有远程仓库
-->

<h2 id="其它-1">其它</h2>

<h3 id="修改远端地址">修改远端地址</h3>

<p>主要所有如下几种方法。</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">----- 0. 查看当前的远端设置
$ git remote -v

----- 1. 直接修改配置
$ git remote set-url origin [URL]
----- 2. 删除后再重新添加
$ git remote rm origin
$ git remote add origin [URL]</code></pre></figure>

<h2 id="常用命令">常用命令</h2>

<figure class="highlight"><pre><code class="language-text" data-lang="text">----- 配置用户名密码
$ git config --global user.name  &quot;Your Name&quot;
$ git config --global user.email &quot;yourname@example.com&quot;
$ git config --list

----- 如果不关心文件权限等，如Windows中
$ git config core.filemode false

----- 初始化或者clone一个库
$ git init
$ git clone https://github.com/user/repository.git
$ git help clone

----- 从远端更新，origin指定远端库，master为远端分支
$ git pull origin master              ← 等价于fetch+merge
$ git fetch origin master             ← 只获取远程分支
$ git merge origin master             ← 手动合并

----- 查看远端服务器，修改origin，以及添加remote分支
$ git remote -v
$ git remote set-url origin http//github.com/repo.git
$ git remote add remote-name https://github.com/user/repo.git

----- 查看提交的差异内容
$ git diff                                               ← 未添加到staged的提交
$ git diff --cached                                      ← 已经staged但是未commited的提交
$ git diff origin/master                                 ← 本地修改与远端master的差异
$ git diff COMMIT1_ID COMMIT2_ID                         ← 两次提交的修改
$ git diff --name-only COMMIT1_ID COMMIT2_ID             ← 只查看修改的文件
$ git diff-tree --no-commit-id --name-only -r COMMIT_ID  ← 某次提交的修改
$ git show --pretty=&quot;format:&quot; --name-only COMMIT_ID      ← 同上
$ git show COMMIT_ID                                     ← 查看详细细节

----- 当前的状态，然后添加到staged，并提交
$ git status
$ git add changed_file.txt
$ git add folder-with-changed-files/
$ git commit -m &quot;Commiting changes&quot;

----- 重命名或者删除一些文件
$ git rm removeme.txt tmp/crap.txt
$ git mv file_oldname.txt file_newname.txt
$ git commit -m &quot;deleting 2 files, renaming 1&quot;

----- 修改最近一次提交的提交信息，并提交到远端
$ git commit --amend -m &quot;New commit message&quot;
$ git push origin master

----- 查看日志
$ git log                                                ← 最近的提交日志
$ git log -2                                             ← 最近的两个提交日志
$ git log -p -2                                          ← 查看最近两次的详细日志
$ git log --pretty=oneline                               ← 单行打印

----- 通过一次提交回退一次提交，会保存一次新的commit
$ git revert dd61ab21
----- 取消一次提交
$ git reset --soft  HEAD~1                               ← 删除上次commit，文件回退到stage
$ git reset --soft  HEAD@{1}
$ git reset --mixed HEAD~1                               ← (默认)删除上次commit，文件回退到工作区
$ git reset --hard  HEAD~1                               ← 彻底回到上次commit，文件回被删除
$ git reset 56e05fced
$ git reset origin/master                                ← 取消本地未提交的内容
$ git fetch origin                                       ← 或者直接获取远端的内容
$ git reset --hard origin/master                         ← 接上

----- 插件本地分支以及所有分支
$ git branch
$ git branch -a

----- 生成patch文件
$ git diff &gt; patch-issue-1.patch                         ← 做些修改，创建patch
$ git add newfile                                        ← 新建文件并创建patch
$ git diff --staged &gt; patch-issue-2.patch                ← 接上
$ git add newfile                                        ← 添加新文件，做些修改并创建一个patch
$ git diff HEAD &gt; patch-issue-2.patch                    ← 接上
$ git format-patch COMMIT_ID                             ← 为某个commit生成patch
$ git format-patch HEAD~2                                ← 最近两次提交生成patch
$ git format-patch origin/master                         ← 为所有未提交内容生成patch
$ git format-patch --binary --full-index origin/master   ← 创建包含二进制文件的patch
$ git apply -v patch-name.patch                          ← 应用patch
$ git am patch1.patch                                    ← 应用通过format-patch生成的patch

----- 获取最近一次提交的完整CommitID以及短ID
$ git rev-parse HEAD
$ git rev-parse --short HEAD

----- 本地分支重命名(还没有推送到远程)
$ git branch -m oldName newName

----- 远程分支重命名(已经推送远程-假设本地分支和远程对应分支名称相同)
--- A. 重命名远程分支对应的本地分支
$ git branch -m oldName newName
--- B. 删除远程分支
$ git push --delete origin oldName
--- C. 上传新命名的本地分支
$ git push origin newName
--- D. 把修改后的本地分支与远程分支关联
$ git branch --set-upstream-to origin/newName

----- 替换已经存在的远端仓库，也就是报remote origin already exists
----- 1. 首先删除origin的远程仓库
$ git remote rm origin
----- 2. 再添加远程git仓库
$ git remote add origin git@github.com:FBing/java-code-generator
$ git push -u origin --all
$ git push -u origin --tags</code></pre></figure>

<!--
Create a tag

git tag 7.x-1.3

Push a tag

git push origin 7.x-1.3

Create a branch

git checkout master
git branch new-branch-name

Here master is the starting point for the new branch. Note that with these 2 commands we don't move to the new branch, as we are still in master and we would need to run git checkout new-branch-name. The same can be achieved using one single command: git checkout -b new-branch-name
Create a branch from a previous commit

git branch branchname 

or using a symbolic reference (e.g. last commit):

git branch branchname HEAD~1

You can also use

git checkout -b branchname 

Source: http://stackoverflow.com/a/2816728/1391963
Checkout a branch

git checkout new-branch-name

See commit history for just the current branch

git cherry -v master

(master is the branch you want to compare)
Merge branch commits

git checkout master
git merge branch-name

Here we are merging all commits of branch-name to master.
Merge a branch without committing

git merge branch-name --no-commit --no-ff

See differences between the current state and a branch

git diff branch-name

See differences in a file, between the current state and a branch

git diff branch-name path/to/file

Delete a branch

git branch -d new-branch-name

Push the new branch

git push origin new-branch-name

Get all branches

git fetch origin

Get the git root directory

git rev-parse --show-toplevel

Source: http://stackoverflow.com/q/957928/1391963
Remove from repository all locally deleted files

git rm $(git ls-files --deleted)

Source: http://stackoverflow.com/a/5147119/1391963
Delete all untracked files

git clean -f

Including directories:

git clean -f -d

Preventing sudden cardiac arrest:

git clean -n -f -d

Source: http://stackoverflow.com/q/61212/1391963
Show total file size difference between two commits

Short answer: Git does not do that.
Long answer: See http://stackoverflow.com/a/10847242/1391963
Unstage (undo add) files:

git reset HEAD file.txt

See closest tag

git describe --tags `git rev-list --tags --max-count=1`

Source. See also git-describe.
Have git pull running every X seconds, with GNU Screen

screen
for((i=1;i<=10000;i+=1)); do sleep 30 && git pull; done

Use Ctrl+a Ctrl+d to detach the screen.
See previous git commands executed

history | grep git

or

grep '^git'  /root/.bash_history

See recently used branches (i.e. branches ordered by most recent commit)

git for-each-ref --sort=-committerdate refs/heads/ | head

Source: http://stackoverflow.com/q/5188320/1391963
Tar project files, excluding .git directory

cd ..
tar cJf project.tar.xz project/ --exclude-vcs

Tar all locally modified files

git diff --name-only | xargs tar -cf project.tar -T -

Look for conflicts in your current files

grep -H -r "<<<" *
grep -H -r ">>>" *
grep -H -r '^=======$' *

There's also git-grep.
Apply a patch not using git:

patch < file.patch
-->

<h2 id="常见错误">常见错误</h2>

<p>记录日常遇到的错误异常。</p>

<h3 id="certificate-issuer">Certificate Issuer</h3>

<p>完整的报错是 <code>Peer's Certificate issuer is not recognized.</code> ，主要是由于 HTTPS 的证书无法识别导致，可以将无法识别的证书添加到根证书，或者直接忽略。</p>

<p>这里简单使用后者。</p>

<!--
cd /etc/ssl/certs/
make SERIAL=5
-->

<figure class="highlight"><pre><code class="language-text" data-lang="text">----- 可以通过环境变量设置忽略SSL校验
$ echo &#39;export GIT_SSL_NO_VERIFY=true&#39; &gt;&gt; ~/.bashrc
$ source ~/.bashrc

----- 也可以在git中进行配置
$ git config http.sslVerify &quot;false&quot;
$ git config --global http.sslVerify false
$ git config http.sslCAinfo /your/path/to/cacert-client.pem</code></pre></figure>

<h3 id="pushdefault">Push.default</h3>

<p>对于 2.0 以后的版本，默认安装之后会有如下的警告信息。</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">warning: push.default is unset; its implicit value is changing in
Git 2.0 from &#39;matching&#39; to &#39;simple&#39;. To squelch this message
and maintain the current behavior after the default changes, use:

  git config --global push.default matching

To squelch this message and adopt the new behavior now, use:

  git config --global push.default simple

See &#39;git help config&#39; and search for &#39;push.default&#39; for further information.
(the &#39;simple&#39; mode was introduced in Git 1.7.11. Use the similar mode
&#39;current&#39; instead of &#39;simple&#39; if you sometimes use older versions of Git)</code></pre></figure>

<p>在 git 中 push 代码时，会有些固定的策略：</p>

<ul>
  <li>nothing 什么都不干 (要它干嘛！ 测试用的？)。</li>
  <li>matching 本地所有的分支都push上去。</li>
  <li>upstream 当本地分支有upstream (也就是有对应的远程分支) 时 Push 到对应的远程分支。</li>
  <li>simple 和 upstream 一样，但不允许将本地分支提交到远程不一样名字的分支。</li>
  <li>current 把当前的分支 push 到远程的同名分支.</li>
</ul>

<p><code>git 1.x</code> 的默认策略是 matching，在 <code>git 2.0</code> 之后 simple 会成为新的默认策略。</p>

<p>matching 不友好之处在于，我们大部分情况都是同步本地的当前分支到远程，如果本地有二三十个分支，那么就会看到大量的刷屏，而且如果其它分支也有更新的话就可能会出现大量的 <code>push fail</code> 信息。</p>

<p>相比来说，simple 这个选项是非常安全的选项，至少能阻止新手误操作覆盖远程分支，所以 git 会在 2.0 时将其作为默认策略。但是需要保证远程与本地的分支名称相同。</p>

<p>大部分情况想要做的只是 push 当前的分支，那么最适合的就是 upstream 。</p>

<p>可以通过如下方式查看、修改全局的配置，相关的配置文件保存在 <code>~/.gitconfig</code> 中。</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">$ git config --global --list
$ git config --global push.default upstream</code></pre></figure>

<h3 id="agent-refused-operation">agent refused operation</h3>

<p>完整的报错如下。</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">sign_and_send_pubkey: signing failed: agent refused operation</code></pre></figure>

<p>一般是在服务器添加完公钥后报错，可以通过执行如下命令方式解决。</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">$ eval &quot;$(ssh-agent -s)&quot;
$ ssh-add</code></pre></figure>

<h2 id="参考">参考</h2>

<p><a href="http://rogerdudler.github.io/git-guide/index.zh.html">git - 简明指南</a>，一些常见的使用命令。</p>

<p><a href="https://git-scm.com/book/zh/v2/Git-%E5%B7%A5%E5%85%B7-%E9%87%8D%E5%86%99%E5%8E%86%E5%8F%B2">Git 工具 - 重写历史</a> 很不错的介绍如何重写历史的工具。</p>

<!--
Git 版本控制系統(3) 還沒 push 前可以做的事
https://ihower.tw/blog/archives/2622
-->


  <hr>
  <nav>
    <ul class="pager">
         <li class="previous"><a href="/post/program-c-string-linux-wildcard-introduce.html" title="C 语言通配符">&larr; Older</a></li> 
         <li class="next"><a href="/post/linux-program-io-multiplexing.html" title="Linux IO 多路复用">Newer &rarr;</a></li> 
    </ul>
  </nav><br>
<!--
  <hr><div id="section-donate"><span>赏</span></div><br>
  <p style="text-indent:0px;text-align:center;">如果喜欢这里的文章，而且又不差钱的话，欢迎打赏个早餐 ^_^</p><br>
  <div class="row" style="text-align:center;" >
    <div class="col-md-6"><img src="/images/system/barcode-pay-alipay.jpg" style="width:150px;height:150px;" title="支付宝捐赠" /><br>支付宝打赏</div>
    <div class="col-md-6"><img src="/images/system/barcode-pay-wechat.jpg" style="width:150px;height:150px;" title="微信捐赠" /><br>微信打赏</div>
  </div><br><hr>
-->
  <p style="text-indent:0px;text-align:center;">如果喜欢这里的文章，而且又不差钱的话，欢迎打赏个早餐 ^_^</p>
  <div id="donate_module">
    <style type="text/css">
      .donate_bar a.btn_donate{
        display: inline-block;
        position:      relative;
        text-align:    center;
        width: 82px;
        height: 82px;
        background: url("/images/misc/btn_reward.gif") no-repeat;
        _background: url("/images/misc/btn_reward.gif") no-repeat;
        -webkit-transition: background 0s;
        -moz-transition: background 0s;
        -o-transition: background 0s;
        -ms-transition: background 0s;
        transition: background 0s;
      }
      .donate_bar a.btn_donate:hover{ background-position: 0px -82px;}
      .donate_bar .donate_txt {
        display: block;
        color: #9d9d9d;
        font: 14px/2 "Microsoft Yahei";
      }
    </style>
    <div id="donate_board" class="donate_bar row" style="text-align:center;" >
      <a id="btn_donate" class="btn_donate" target="_self" href="javascript:;" title="Donate 打赏"></a>
    </div>
    <div id="donate_guide" class="donate_bar center hidden">
      <div class="row" style="text-align:center;" >
        <div class="col-md-6"><img src="/images/system/barcode-pay-alipay.jpg" style="width:150px;height:150px;" title="支付宝捐赠" /><br>支付宝打赏</div>
        <div class="col-md-6"><img src="/images/system/barcode-pay-wechat.jpg" style="width:150px;height:150px;" title="微信捐赠" /><br>微信打赏</div>
      </div>
    </div>
    <script type="text/javascript">
      document.getElementById('btn_donate').onclick = function(){
        $('#donate_board').addClass('hidden');
        $('#donate_guide').removeClass('hidden');
      }
      function donate_on_web(){
        $('#donate').submit();
      }
    </script>
  </div>

  <hr>

  <div id="gitmentContainer"></div>
  <link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
  <script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
  <script>
  var gitment = new Gitment({
      id: '1441814400',
      owner: 'Jin-Yang',
      repo: 'jin-yang.github.com',
      oauth: {
          client_id: '6d89d48ce689192bf95d',
          client_secret: 'c9a720aafb8e3084e3feb46cadee80b03cdc792f',
      },
  });
  gitment.render('gitmentContainer');
  </script>

  <!-- 多说评论框 start -->
  <!--<div class="ds-thread" data-thread-key="请将此处替换成文章在你的站点中的ID" data-title="请替换成文章的标题" data-url="请替换成文章的网址"></div>-->
  <!--
  <div class="ds-thread" data-thread-key="/post/git-tips.html" data-title="Git 使用杂项" data-url="/post/git-tips.html"></div>
  -->
  <!-- 多说评论框 end -->
  <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
  <!--
  <script type="text/javascript">
      var duoshuoQuery = {short_name:"jinyangposts"};
      (function() {
          var ds = document.createElement('script');
          ds.type = 'text/javascript';ds.async = true;
          ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
          ds.charset = 'UTF-8';
          (document.getElementsByTagName('head')[0]
           || document.getElementsByTagName('body')[0]).appendChild(ds);
      })();
  </script>
  -->
  <!-- 多说公共JS代码 end -->
</div>

    </div>
    <div class="col-lg-3 visible-lg blog-sidebar">
    <center><a href="/"><img src="/images/system/linux-liberty.png" width="200" /></a></center>
<h2>About This Blog</h2>
<div class="sidebar-module">
<p style="text-indent:0em;margin:0px;padding:0px;">This is a personal weblog ^_^ generated with Jekyll, if you like it or have some questions,
just feel free to contact me :)</p>
</div><!-- end of "node" "about" -->



<h2>Recent Posts</h2>
<div class="list-group">
  
    <a class="list-group-item" href="/post/linux-program-cpu-cache-introduce_init.html">CPU Cache</a>
  
    <a class="list-group-item" href="/post/artificial-intelligence-decision-tree-introduce.html">决策树</a>
  
    <a class="list-group-item" href="/post/linux-ebpf-bcc-tools-introduce.html">BCC 工具使用</a>
  
    <a class="list-group-item" href="/post/linux-ebpf-basic-usage-introduce.html">eBPF 简介</a>
  
    <a class="list-group-item" href="/post/math-monte-carlo-sample-introduce.html">采样算法</a>
  
</div>

<h2>Categories</h2>
<ul class="list-group" style="margin:0px;">
  
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#bash"> bash</a>
    <span class="badge">2</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#database"> database</a>
    <span class="badge">86</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#golang"> golang</a>
    <span class="badge">28</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#linux"> linux</a>
    <span class="badge">301</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#misc"> misc</a>
    <span class="badge">244</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#mysql"> mysql</a>
    <span class="badge">79</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#network"> network</a>
    <span class="badge">49</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#postgresql"> postgresql</a>
    <span class="badge">4</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#program"> program</a>
    <span class="badge">138</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#python"> python</a>
    <span class="badge">25</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#react"> react</a>
    <span class="badge">1</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#rtems"> rtems</a>
    <span class="badge">1</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#sql"> sql</a>
    <span class="badge">10</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#tools"> tools</a>
    <span class="badge">1</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#webserver"> webserver</a>
    <span class="badge">25</span>
  </li>
  
</ul><!-- end of "node" "categories" -->

<h2>Related Links</h2>
<ul class="list-group" style="margin:0px">
  <li style="margin-left:0em" class="list-group-item">
    <div class="row">
      <div class="col-xs-4">
       <a href="http://www.rtems.org" title="To RTEMS"><img class="img-thumbnail img-responsive" src="/images/system/rtems.png"  alt="RTEMS"/></a>
      </div>
      <div class="col-xs-8 center-block" style="padding:0px;">
        <strong>RTEMS</strong><br>
        <div class="sidebar-description">Real-Time Executive for Multiprocessor System</div>
      </div>
    </div>
  </li>
  <li style="margin-left:0em" class="list-group-item">
    <div class="row">
      <div class="col-xs-4">
       <a href="http://www.gnu.org" title="To GNU">
       <img class="img-thumbnail img-responsive" src="/images/system/gnu.jpg" alt="GNU" /></a>
      </div>
      <div class="col-xs-8 center-block" style="padding:0px;">
        <strong>GNU</strong><br>
        <div class="sidebar-description">A Unix-linux Operating System</div>
      </div>
    </div>
  </li>
  <li style="margin-left:0em" class="list-group-item">
    <div class="row">
      <div class="col-xs-4">
    <a href="http://www.kernel.org" title="To Linux Kernel">
    <img class="img-thumbnail img-responsive" src="/images/system/linux.png"  alt="LINUX" /></a>
      </div>
      <div class="col-xs-8 center-block" style="padding:0px;">
        <strong>Linux Kernel</strong><br>
        <div class="sidebar-description">Maintained by Linux Kernel Organization</div>
      </div>
    </div>
  </li>
  <li style="margin-left:0em" class="list-group-item">
    <div class="row">
      <div class="col-xs-4">
    <a href="http://arduino.cc" title="To Arduino">
    <img class="img-thumbnail img-responsive" src="/images/system/arduino.png"  alt="ARDUINO" /></a>
      </div>
      <div class="col-xs-8 center-block" style="padding:0px;">
        <strong>Arduino</strong><br>
        <div class="sidebar-description">Open-source Electronic Prototyping Platform</div>
      </div>
    </div>
  </li>
</ul>

<h2>Search</h2>
<div class="sidebar-module">
  <form class="search" method="GET" action="https://www.google.com.hk/search">
    <input type="text" name="q" class="search-query" placeholder=" Search on Google">
    <input type="hidden" name="ie" value="utf-8">
    <input type="submit" name="sa" value="Search" />
  </form><br>
  <input type="text" class="search-field" placeholder=" Search This Site">
  <div class="search-results"></div>
</div>



    </div>
  </div>
<hr><p class="text-center">This Site was built by Jin Yang, generated with Jekyll, and hosted on GitHub Pages<br/> &copy;2013-2019 &ndash; Jin Yang</p><div class="footer-logo"></div>

</div>
</body>
</html>
