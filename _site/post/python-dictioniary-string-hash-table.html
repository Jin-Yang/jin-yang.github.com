<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
  <meta name="baidu-site-verification" content="B786jeR0MV" />
  <meta name="msvalidate.01" content="29F791E7F785800340E37AD7C714D2A7" />
  <meta name="google-site-verification" content="p7jJ5d3kF9yxRhpIo5GgHXAZ1ATKVyZhV2kf6mEGOv0" />
  <title>Python 字典对象实现|JinYang's Blog</title>
  <meta name="keywords" content="python,dictionary,字典,hash table,哈希表,冲突">
  <meta name="description" content="在 Python 中有一个字典，可以看作是一个 Key Value 对，其代码是通过哈希表实现，也就是说，字典是一个数组，而数组的索引是键经过哈希函数处理后得到的。Python 字典是用哈希表 (hash table) 实现，哈希表是一个数组，它的索引是对键运用哈希函数计算求得的。一个好的哈希函数会将冲突数量降到最小，将各个值均匀分布到数组中，而 Python 中的哈希函数 (主要用于字符串和整数) 很常规：冲突时采用开放寻址，相比链表来说，其 CPU Cache 的命中率更高。这里简单结合 Python 中 Hash 函数的实现。">

  <script src="https://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
  <script type="text/javascript">
  !window.jQuery && document.write('<script src="/static/js/jquery.min.js"><\/script>');
  </script>
  <script src="https://cdn.bootcss.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
  <script type="text/javascript">
  !$('body').popover && document.write('<script src="/static/js/bootstrap.min.js"><\/script>');
  </script>
  <script type="text/javascript" src="/static/js/main.js"></script>
  <!-- <link rel="stylesheet prefetch" href="http://cdn.bootcss.com/bootstrap/3.3.0/css/bootstrap.min.css"> -->
  <link type="text/css" rel="stylesheet prefetch" href="/static/css/bootstrap.min.css">
  <!-- <link href="http://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"> -->
  <link type="text/css" rel="stylesheet prefetch" href="/static/css/font-awesome.min.css">
  <link type="text/css" rel="stylesheet prefetch" href="/static/css/pygments.css">
  <link type="text/css" rel="stylesheet prefetch" href="/static/css/screen.css">
  <style type="text/css">
  
    .post-container > p {text-indent: 2em;}
  
  </style>
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-124556620-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-124556620-1');
</script>

</head>

<body>
<nav class="navbar navbar-default navbar-inverse navbar-fixed-top navbar-wrapper">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
      </button><a class="navbar-brand" href="/">Jin-Yang</a>
    </div>
    <div id="navbar" class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        <li  ><a href="/"> Home </a></li>
        <li  ><a href="/archives.html"> Archive </a></li>
        <li  ><a href="/categories.html"> Categories </a></li>
        <li  ><a href="/projects.html"> Projects </a></li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"> Others <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li class="dropdown-header">常用网站</li>
            <li role="separator" class="divider"></li>
            <li><a href="https://www.rtems.org/">www.rtems.org</a></li>
            <li><a href="http://www.gnu.org/">www.gnu.org</a></li>
            <li><a href="https://www.kernel.org/">www.kernel.org</a></li>
            <li><a href="https://www.arduino.cc/">www.arduino.cc</a></li>
          </ul>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li  ><a href="/about.html"> About </a></li>
      </ul>
    </div><!--/.nav-collapse -->
  </div>
</nav>

<div id="myCarousel" class="carousel slide" data-ride="carousel">
  <!-- Indicators -->
  <ol class="carousel-indicators">
    <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
    <li data-target="#myCarousel" data-slide-to="1"></li>
    <li data-target="#myCarousel" data-slide-to="2"></li>
    <li data-target="#myCarousel" data-slide-to="3"></li>
    <li data-target="#myCarousel" data-slide-to="4"></li>
  </ol>
  <div class="carousel-inner" role="listbox">
    <div class="item active">
      <img src="data:image/gif;base64,R0lGODlhAQABAIAAAGZmZgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="Second slide">
      <div class="container">
        <div class="carousel-caption">
          <h1>KISS</h1>
          <h2>Keep It Simple and Stupid.</h2>
          <!--<a class="btn btn-lg btn-primary" href="#" role="button">Sign up today</a>-->
        </div>
      </div>
    </div>
    <div class="item">
      <img src="data:image/gif;base64,R0lGODlhAQABAIAAAGZmZgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="Second slide">
      <div class="container">
        <div class="carousel-caption">
          <h1>Seize The Day</h1><h1>And Get Busy Living</h1>
        </div>
      </div>
    </div>
    <div class="item">
      <img src="data:image/gif;base64,R0lGODlhAQABAIAAAGZmZgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="Second slide">
      <div class="container">
        <div class="carousel-caption">
          <h1>Stay hungry</h1><h1>Stay foolish</h1>
        </div>
      </div>
    </div>
    <div class="item">
      <img src="data:image/gif;base64,R0lGODlhAQABAIAAAGZmZgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="Second slide">
      <div class="container">
        <div class="carousel-caption">
	  <h2>Ever tried, ever failed</h2><h2>No matter, try again</h2><h2>Fail again, fail better</h2>
        </div>
      </div>
    </div>
    <div class="item">
      <img src="data:image/gif;base64,R0lGODlhAQABAIAAAGZmZgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==" alt="Second slide">
      <div class="container">
        <div class="carousel-caption">
          <h1>Nothing is true</h1><h1>Every is permitted</h1>
        </div>
      </div>
    </div>
  </div>
  <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
    <span class="glyphicon glyphicon-chevron-left"></span>
    <span class="sr-only">Previous</span>
  </a>
  <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
    <span class="glyphicon glyphicon-chevron-right"></span>
    <span class="sr-only">Next</span>
  </a>
</div><!-- /.carousel -->

<div class="container">
  <div class="row">
    <div class="col-lg-9 blog-main" style="min-width: 500px">
    
<div class="post-container">
  <div class="blog-header">
    <h1>Python 字典对象实现</h1>
    <div class="post-description">
      <i class="fa fa-calendar"></i> 2017-01-08 Sunday &nbsp; &nbsp;
      <i class="fa fa-tags"></i>  python  
      
    </div>
  </div>
  <hr>
  <p>在 Python 中有一个字典，可以看作是一个 Key Value 对，其代码是通过哈希表实现，也就是说，字典是一个数组，而数组的索引是键经过哈希函数处理后得到的。</p>

<p>Python 字典是用哈希表 (hash table) 实现，哈希表是一个数组，它的索引是对键运用哈希函数计算求得的。</p>

<p>这里简单结合 Python 中 Hash 函数的实现。</p>

<!-- more -->

<h2 id="字典使用">字典使用</h2>

<p>一个好的哈希函数会将冲突数量降到最小，将各个值均匀分布到数组中，不过，对于 Python 中的哈希函数 (主要用于字符串和整数) 很常规，冲突时采用开放寻址法，相比于链表来说，其 CPU Cache 的命中率更高。</p>

<p>如下是经常的使用方法。</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">----- 创建初始化字典对象
info = {&quot;name&quot; : &quot;foobar&quot;, &quot;gender&quot;: &quot;male&quot;}
info = dict(name = &#39;foobar&#39;, gender = &#39;male&#39;)

----- 对于第二种方式，在如下场景时可能会出现隐藏的bug
key = &#39;name&#39;
info = { key :&#39;foobar&#39;}     # {&#39;name&#39;:&#39;foobar&#39;}
info = dict(key = &#39;foobar&#39;) # {&#39;key&#39;: &#39;foobar&#39;}

----- 可以通过fromkeys函数进行初始化，值默认是None，也可以通过第二个参数指定默认值
info = {}.fromkeys([&#39;name&#39;, &#39;gender&#39;])              # {&#39;gender&#39; : None, &#39;name&#39; : None}
info = dict().fromkeys([&#39;name&#39;, &#39;gender&#39;])          # {&#39;gender&#39; : None, &#39;name&#39; : None}
info = {}.fromkeys([&#39;name&#39;, &#39;gender&#39;], &#39;invalid&#39;)   # {&#39;gender&#39; : &#39;invalid&#39;, &#39;name&#39; : &#39;invalid&#39;}

----- 获取值
print info[&#39;name&#39;]                 # 不存在时会触发KeyError异常
print info.get(&#39;name&#39;)             # 不存在返回None而非异常
print info.get(&#39;notexist&#39;, &#39;oops&#39;) # 不存在时返回指定的默认值

----- 更新、添加、删除
info[&#39;name&#39;] = &#39;kidding&#39;
info.update({&#39;name&#39;:&#39;kidding&#39;, &#39;gender&#39;:&#39;female&#39;})
info.update(name=&#39;kidding&#39;, blog=&#39;female&#39;)
del info[&#39;name&#39;]                   # 或者info.pop(&#39;name&#39;)

d.keys()
for key, value in info.items():
    print key, &#39;:&#39;,  value</code></pre></figure>

<p>如上，key 可以是 int 和 string 的混合。</p>

<h3 id="setdefault">setdefault</h3>

<p>Python 地址中有一个 <code>setdefault</code> 函数，主要是用于获取信息，如果获取不到就按照它的参数设置该值。</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">a</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;key&quot;</span><span class="p">:</span> <span class="s">&quot;hello world&quot;</span> <span class="p">}</span>
<span class="n">a</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s">&quot;key&quot;</span><span class="p">,</span> <span class="s">&quot;456&quot;</span><span class="p">))</span>   <span class="c"># 因为之前已经设置了key对应的值，此时不会设置</span>

<span class="n">a</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s">&quot;key_sth&quot;</span><span class="p">,</span> <span class="s">&quot;123&quot;</span><span class="p">))</span>   <span class="c"># 之前没有设置，此时会设置</span></code></pre></figure>

<h2 id="源码解析">源码解析</h2>

<p>实际上，计算的 Hash 值，可以通过如下的函数进行计算。</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">&gt;&gt;&gt; map(hash, (0, 1, 2, 3))
[0, 1, 2, 3]
&gt;&gt;&gt; map(hash, (&quot;namea&quot;, &quot;nameb&quot;, &quot;namec&quot;, &quot;named&quot;))
[-6456208310023038713, -6456208310023038716, -6456208310023038715, -6456208310023038718]</code></pre></figure>

<h3 id="entry">Entry</h3>

<p>准确来说，是 CPython 中的实现，其对应的结构体如下。</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">Py_ssize_t</span> <span class="n">me_hash</span><span class="p">;</span> <span class="c1">// 缓存me_key的hash值，防止每次查询都要计算</span>
	<span class="n">PyObject</span> <span class="o">*</span><span class="n">me_key</span><span class="p">;</span>
	<span class="n">PyObject</span> <span class="o">*</span><span class="n">me_value</span><span class="p">;</span>
<span class="p">}</span> <span class="n">PyDictEntry</span><span class="p">;</span></code></pre></figure>

<p>每个 <code>PyDictEntry</code> 包含了三种状态：</p>

<ul>
  <li>Unused <code>me_key == me_value == NULL</code> 初始状态。</li>
  <li>Active <code>me_key != NULL and me_key != dummy and me_value != NULL</code> 插入元素后就成了 Active 状态，这是 <code>me_value</code> 唯一不为 <code>NULL</code> 的情况，删除元素时 Active 状态刻转换成 Dummy 状态。</li>
  <li>Dummy <code>me_key == dummy and me_value == NULL</code>  dummy 实际上一个 <code>PyStringObject</code> 对象，仅作为指示标志。</li>
</ul>

<p>Dummy 的元素可以在插入元素的时候将它变成 Active ，但它不能再变成 Unused 。</p>

<h4 id="why-dummy">Why Dummy</h4>

<p>为什么 entry 有 Dummy 状态呢？</p>

<p>在开放寻址法中，如果某元素经过哈希计算应该插入到 A 处，但是此时 A 处有元素的，通过探测函数计算得到下一个位置 B，仍然有元素，直到找到位置 C 为止。</p>

<p>此时 ABC 构成了探测链，查找元素时如果 hash 值相同，那么也是顺着这条探测链不断往后找，当删除探测链中的某个元素时，比如 B，如果直接把 B 从哈希表中移除，即变成 Unused 状态，那么 C 就不可能再找到了，因为 AC 之间出现了断裂的现象。</p>

<p>正是如此才出现了第三种状态 Dummy，这是一种类似的伪删除方式，保证探测链的连续性。</p>

<h3 id="dict">Dict</h3>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">struct</span> <span class="n">_dictobject</span> <span class="p">{</span>
	<span class="n">PyObject_HEAD</span>
	<span class="n">Py_ssize_t</span> <span class="n">ma_fill</span><span class="p">;</span>          <span class="o">//</span> <span class="n">Active</span><span class="o">+</span><span class="n">Dummy</span>
	<span class="n">Py_ssize_t</span> <span class="n">ma_used</span><span class="p">;</span>          <span class="o">//</span> <span class="n">Active</span>
	<span class="n">Py_ssize_t</span> <span class="n">ma_mask</span><span class="p">;</span>          <span class="o">//</span> <span class="err">总共有</span><span class="n">ma_mask</span><span class="o">+</span><span class="mi">1</span><span class="err">个</span><span class="n">slots</span><span class="err">，可以通过</span><span class="n">key_hash</span><span class="o">&amp;</span><span class="n">ma_mask</span><span class="err">得到对应的</span><span class="n">slot</span>
	<span class="n">PyDictEntry</span> <span class="o">*</span><span class="n">ma_table</span><span class="p">;</span>       <span class="o">//</span> <span class="err">保存的</span><span class="nb">hash</span><span class="err">表</span>
	<span class="n">PyDictEntry</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">ma_lookup</span><span class="p">)(</span><span class="n">PyDictObject</span> <span class="o">*</span><span class="n">mp</span><span class="p">,</span> <span class="n">PyObject</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span> <span class="nb">long</span> <span class="nb">hash</span><span class="p">);</span>
	<span class="n">PyDictEntry</span> <span class="n">ma_smalltable</span><span class="p">[</span><span class="n">PyDict_MINSIZE</span><span class="p">];</span>
<span class="p">};</span></code></pre></figure>

<!--
PyDict_New() 创建新字典对象
 |-PyString_FromString() 第一次会初始化dummy对象
 |-PyObject_GC_New() 如果没有缓存，则通过该函数创建一个

Dict 对象的插入
字典对象的插入实际是通过 PyDict_SetItem() 函数完成，简单来说就是，如果不存在 Key-Value 则插入，存在则覆盖；基本的处理步骤如下：

1. 通过 ma_lookup 所指向的函数得到 key 所对应的 entry，该函数对于字符串来说是 lookdict_string()，整形是 lookdict()；
2. 返回的值分为如下几种场景：
   * me_key = NULL 空不存在，可以直接使用；
   * me_key = key 对应的值已经存在，可以直接返回；
   * me_hash = hash && 字符串相同，不同的 key 对象，但是值相同，同样认为相同；
   * me_key = dummy 对应的值已经删除；
   * 冲突，通过如下方式探测。

PyDict_SetItem()
 |-PyString_CheckExact()  如果是string对象，那么实际会通过string_hash计算hash值
 |-PyObject_Hash()  否则是int类型，则通过int_hash计算hash值
 |-dict_set_item_by_hash_or_entry() 其中entry为0，也就是通过hash添加，会判断是否调整大小
   |-insertdict()  实际调用这里的接口
   | |-ma_lookup() 通过该指针指向的对象查找，一般默认为lookdict_string()函数
   | |-insertdict_by_entry()
   |-insertdict_by_entry()
   |-dictresize() 只有在插入的时候会调整字典的大小

TODO:
  校验下，循环中可以替换，但是无法新增或者删除。

https://morepypy.blogspot.com/2015/01/faster-more-memory-efficient-and-more.html
https://www.laurentluce.com/posts/python-dictionary-implementation/
https://www.hongweipeng.com/index.php/archives/1230/
https://zhuanlan.zhihu.com/p/25071851
https://github.com/Junnplus/blog/issues/15
https://juejin.im/entry/5bc57c8ef265da0a972e49d1
https://arianx.me/2018/12/30/walkthrough-cpython3.7-dict-source-code/
https://blog.csdn.net/weixin_33975951/article/details/89698890
https://www.cnblogs.com/adinosaur/p/7259814.html
https://github.com/clibs/logfmt
这里的 Hash 表实际上有两类，分别是 Key-Value 结构，以及 Hash-Object，也就是前者需要在对象中同时保存 Key 和 Value 的值，而后者则直接以 Object 方式存储，只有用户需要知道具体值的含义。

在 Python 3.6 版本中，对字典对象进行了较大的优化，尤其是内存使用效率方面，其基本的东西改动不太大，例如 Hash 值计算方法、冲突解决策略等。

这里简单介绍其实现的详细细节。

## 简介

对于内存的优化有很多方面。

### 成员对象

内存中 dict 对象的成员如下。

+---------------+
| dk_refcnt     |
| dk_size       |   哈希表indices的大小
| dk_lookup     |
| dk_usable     |
| dk_nentries   |
+---------------+
| dk_indices    |   实际hash表，保存了entries中的序列
|               |
+---------------+
| dk_entries    |
|               |
+---------------+

为了尽量减少空间的使用，会根据不同的 dk_size 选择不同类型的整数，也就是 `dk_entreis` 中的序号，方法如下。

int8  for          dk_size <= 128
int16 for 256   <= dk_size <= 2**15
int32 for 2**16 <= dk_size <= 2**31
int64 for 2**32 <= dk_size

其中 `dk_entries` 是 `PyDictKeyEntry` 类型的数组，保存了真正的对象，可以通过 `DK_ENTRIES(dk)` 获取 `dk_entries` 的指针。

之所以采用索引 `dk_indices` 和对象 `dk_entreis` 分离，主要是为了节省空间。

    d = {'timmy': 'red', 'barry': 'green', 'guido': 'blue'}
    entries = [['--', '--', '--'],
               [-8522787127447073495, 'barry', 'green'],
               ['--', '--', '--'],
               ['--', '--', '--'],
               ['--', '--', '--'],
               [-9092791511155847987, 'timmy', 'red'],
               ['--', '--', '--'],
               [-6480567542315338377, 'guido', 'blue']]
    indices =  [None, 1, None, None, None, 0, None, 2]
    entries =  [[-9092791511155847987, 'timmy', 'red'],
                [-8522787127447073495, 'barry', 'green'],
                [-6480567542315338377, 'guido', 'blue']]
### Combined VS. Split

在 `PyDictObject` 中的注释可以看到，实际上在 dict 内存中会保存两种形式：

* Combined `ma_values=NULL dk_refcnt=1` 而对应的 Keys Values 会保存在 ma_keys 中；
* Split `ma_values != NULL dk_refcnt >= 1` 此时 Keys Values 会分别存储在 ma_keys 和 ma_values 中。

新版的 dict 有两种形式，分别是 combined 和 split，后者主要用在优化对象存储属性的 `tp_dict` 上。

这种字典的 key 是共享的，此时会有一个引用计数器 `dk_refcnt` 来维护当前被引用的个数，这一场景使用比较多的是实例对象上的属性字典 tp_dict 。

主要对应这样的场景：

1. 一个类会创建出很多个对象；
2. 这些对象的属性，能在一开始就确定下来，并且后续不会增加删除。

如果能满足上述两个条件，那么可以使用一种更高效、更省内存的方式，来存储对象的属性。

也就是，属于一个类的所有对象共享同一份属性字典的 key，而 value 以数组的方式存储在每个对象的身上，这样只需要维护一份对象属性即可，而值则可以更加紧凑的方式组织在内存中。

PEP 412 -- Key-Sharing Dictionary
https://www.python.org/dev/peps/pep-0412/


## 源码介绍

与字典相关的对象实现在 `Objects/dictobject.c` `Include/dictobject.h` `Objects/dict-common.h` 文件中，

### 结构体

#### Key Value

// Objects/dict-common.h
typedef struct {
    Py_hash_t me_hash; // 缓存计算的hash值
    PyObject *me_key;
    PyObject *me_value;
} PyDictKeyEntry;

每次向字典写入数据时，实际上就会向哈希表中插入一个 PyDictKeyEntry，包括了 Key 和 Value 的值。其中 `Py_hash_t` 一般是 `ssize_t` ，所以如果是 64 位的系统，那么整个结构体会占用 24 字节。

#### 字典

在 `PyDictKeysObject` 对象中储存了实际的哈希表，但是这里保存的大部分是与该字典相关的元数据，没有对应 `PyDictKeyEntry` 数组之类的成员来保存 Hash 表。

实际上，对应的是 `dk_indices` ，这是一个指针，在 3.6 之后为了提高内存使用效率做了双重映射，老版本的实际会保存一个 `PyDictKeyEntry*` 的数组。

#### 解析器对象

上述介绍的都是 CPython 内部实现的一些结构体，而真正暴露给解析器的对象是 `PyDictObject` 。

typedef struct {
    PyObject_HEAD               // 对象通用的头
    Py_ssize_t ma_used;         // 字典元素个数，len()函数依赖该字段，所以在这里暴露出来
    uint64_t ma_version_tag;    // 全局版本，优化后面讲
    PyDictKeysObject *ma_keys;
    PyObject **ma_values;       // 用来保存split table的数据
} PyDictObject;

#### 其它

对于 `PyDictKeysObject` 来说，

## 操作 Hash 表

首先看下内部是怎么使用 Hash 表的，而对外提供的 Python 接口都是对这些函数的封装。

###

dk_get_index() 通过dk_indices获取在dk_entries中的索引
dk_set_index()

lookdict() 查询HASH表，这就是核心的函数

## 参考

[More compact dictionaries with faster iteration](https://mail.python.org/pipermail/python-dev/2012-December/123028.html) 新的数据结构如何对内存进行优化的。


-->

<h2 id="参考">参考</h2>

<p>详细可以参考 <a href="http://python.jobbole.com/85040/">深入 Python 字典的内部实现</a> 以及其原文 <a href="http://www.laurentluce.com/posts/python-dictionary-implementation/">Python dictionary implementation</a> 。</p>

<!--
摘抄出来的实现
http://www.cnblogs.com/xiangnan/p/3859578.html
-->


  <hr>
  <nav>
    <ul class="pager">
         <li class="previous"><a href="/post/linux-virtual-kvm-introduce.html" title="KVM 虚拟平台">&larr; Older</a></li> 
         <li class="next"><a href="/post/linux-program-pthread-atomic-free-lock_init.html" title="C 无锁编程">Newer &rarr;</a></li> 
    </ul>
  </nav><br>
<!--
  <hr><div id="section-donate"><span>赏</span></div><br>
  <p style="text-indent:0px;text-align:center;">如果喜欢这里的文章，而且又不差钱的话，欢迎打赏个早餐 ^_^</p><br>
  <div class="row" style="text-align:center;" >
    <div class="col-md-6"><img src="/images/system/barcode-pay-alipay.jpg" style="width:150px;height:150px;" title="支付宝捐赠" /><br>支付宝打赏</div>
    <div class="col-md-6"><img src="/images/system/barcode-pay-wechat.jpg" style="width:150px;height:150px;" title="微信捐赠" /><br>微信打赏</div>
  </div><br><hr>
-->
  <p style="text-indent:0px;text-align:center;">如果喜欢这里的文章，而且又不差钱的话，欢迎打赏个早餐 ^_^</p>
  <div id="donate_module">
    <style type="text/css">
      .donate_bar a.btn_donate{
        display: inline-block;
        position:      relative;
        text-align:    center;
        width: 82px;
        height: 82px;
        background: url("/images/misc/btn_reward.gif") no-repeat;
        _background: url("/images/misc/btn_reward.gif") no-repeat;
        -webkit-transition: background 0s;
        -moz-transition: background 0s;
        -o-transition: background 0s;
        -ms-transition: background 0s;
        transition: background 0s;
      }
      .donate_bar a.btn_donate:hover{ background-position: 0px -82px;}
      .donate_bar .donate_txt {
        display: block;
        color: #9d9d9d;
        font: 14px/2 "Microsoft Yahei";
      }
    </style>
    <div id="donate_board" class="donate_bar row" style="text-align:center;" >
      <a id="btn_donate" class="btn_donate" target="_self" href="javascript:;" title="Donate 打赏"></a>
    </div>
    <div id="donate_guide" class="donate_bar center hidden">
      <div class="row" style="text-align:center;" >
        <div class="col-md-6"><img src="/images/system/barcode-pay-alipay.jpg" style="width:150px;height:150px;" title="支付宝捐赠" /><br>支付宝打赏</div>
        <div class="col-md-6"><img src="/images/system/barcode-pay-wechat.jpg" style="width:150px;height:150px;" title="微信捐赠" /><br>微信打赏</div>
      </div>
    </div>
    <script type="text/javascript">
      document.getElementById('btn_donate').onclick = function(){
        $('#donate_board').addClass('hidden');
        $('#donate_guide').removeClass('hidden');
      }
      function donate_on_web(){
        $('#donate').submit();
      }
    </script>
  </div>

  <hr>

  <div id="gitmentContainer"></div>
  <link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
  <script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
  <script>
  var gitment = new Gitment({
      id: '1483804800',
      owner: 'Jin-Yang',
      repo: 'jin-yang.github.com',
      oauth: {
          client_id: '6d89d48ce689192bf95d',
          client_secret: 'c9a720aafb8e3084e3feb46cadee80b03cdc792f',
      },
  });
  gitment.render('gitmentContainer');
  </script>

  <!-- 多说评论框 start -->
  <!--<div class="ds-thread" data-thread-key="请将此处替换成文章在你的站点中的ID" data-title="请替换成文章的标题" data-url="请替换成文章的网址"></div>-->
  <!--
  <div class="ds-thread" data-thread-key="/post/python-dictioniary-string-hash-table.html" data-title="Python 字典对象实现" data-url="/post/python-dictioniary-string-hash-table.html"></div>
  -->
  <!-- 多说评论框 end -->
  <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
  <!--
  <script type="text/javascript">
      var duoshuoQuery = {short_name:"jinyangposts"};
      (function() {
          var ds = document.createElement('script');
          ds.type = 'text/javascript';ds.async = true;
          ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
          ds.charset = 'UTF-8';
          (document.getElementsByTagName('head')[0]
           || document.getElementsByTagName('body')[0]).appendChild(ds);
      })();
  </script>
  -->
  <!-- 多说公共JS代码 end -->
</div>

    </div>
    <div class="col-lg-3 visible-lg blog-sidebar">
    <center><a href="/"><img src="/images/system/linux-liberty.png" width="200" /></a></center>
<h2>About This Blog</h2>
<div class="sidebar-module">
<p style="text-indent:0em;margin:0px;padding:0px;">This is a personal weblog ^_^ generated with Jekyll, if you like it or have some questions,
just feel free to contact me :)</p>
</div><!-- end of "node" "about" -->



<h2>Recent Posts</h2>
<div class="list-group">
  
    <a class="list-group-item" href="/post/linux-program-cpu-cache-introduce_init.html">CPU Cache</a>
  
    <a class="list-group-item" href="/post/artificial-intelligence-decision-tree-introduce.html">决策树</a>
  
    <a class="list-group-item" href="/post/linux-ebpf-bcc-tools-introduce.html">BCC 工具使用</a>
  
    <a class="list-group-item" href="/post/linux-ebpf-basic-usage-introduce.html">eBPF 简介</a>
  
    <a class="list-group-item" href="/post/math-monte-carlo-sample-introduce.html">采样算法</a>
  
</div>

<h2>Categories</h2>
<ul class="list-group" style="margin:0px;">
  
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#bash"> bash</a>
    <span class="badge">2</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#database"> database</a>
    <span class="badge">86</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#golang"> golang</a>
    <span class="badge">28</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#linux"> linux</a>
    <span class="badge">301</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#misc"> misc</a>
    <span class="badge">244</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#mysql"> mysql</a>
    <span class="badge">79</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#network"> network</a>
    <span class="badge">49</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#postgresql"> postgresql</a>
    <span class="badge">4</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#program"> program</a>
    <span class="badge">138</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#python"> python</a>
    <span class="badge">25</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#react"> react</a>
    <span class="badge">1</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#rtems"> rtems</a>
    <span class="badge">1</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#sql"> sql</a>
    <span class="badge">10</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#tools"> tools</a>
    <span class="badge">1</span>
  </li>
  
    <li style="margin-left:0em" class="list-group-item"><a href="/categories.html#webserver"> webserver</a>
    <span class="badge">25</span>
  </li>
  
</ul><!-- end of "node" "categories" -->

<h2>Related Links</h2>
<ul class="list-group" style="margin:0px">
  <li style="margin-left:0em" class="list-group-item">
    <div class="row">
      <div class="col-xs-4">
       <a href="http://www.rtems.org" title="To RTEMS"><img class="img-thumbnail img-responsive" src="/images/system/rtems.png"  alt="RTEMS"/></a>
      </div>
      <div class="col-xs-8 center-block" style="padding:0px;">
        <strong>RTEMS</strong><br>
        <div class="sidebar-description">Real-Time Executive for Multiprocessor System</div>
      </div>
    </div>
  </li>
  <li style="margin-left:0em" class="list-group-item">
    <div class="row">
      <div class="col-xs-4">
       <a href="http://www.gnu.org" title="To GNU">
       <img class="img-thumbnail img-responsive" src="/images/system/gnu.jpg" alt="GNU" /></a>
      </div>
      <div class="col-xs-8 center-block" style="padding:0px;">
        <strong>GNU</strong><br>
        <div class="sidebar-description">A Unix-linux Operating System</div>
      </div>
    </div>
  </li>
  <li style="margin-left:0em" class="list-group-item">
    <div class="row">
      <div class="col-xs-4">
    <a href="http://www.kernel.org" title="To Linux Kernel">
    <img class="img-thumbnail img-responsive" src="/images/system/linux.png"  alt="LINUX" /></a>
      </div>
      <div class="col-xs-8 center-block" style="padding:0px;">
        <strong>Linux Kernel</strong><br>
        <div class="sidebar-description">Maintained by Linux Kernel Organization</div>
      </div>
    </div>
  </li>
  <li style="margin-left:0em" class="list-group-item">
    <div class="row">
      <div class="col-xs-4">
    <a href="http://arduino.cc" title="To Arduino">
    <img class="img-thumbnail img-responsive" src="/images/system/arduino.png"  alt="ARDUINO" /></a>
      </div>
      <div class="col-xs-8 center-block" style="padding:0px;">
        <strong>Arduino</strong><br>
        <div class="sidebar-description">Open-source Electronic Prototyping Platform</div>
      </div>
    </div>
  </li>
</ul>

<h2>Search</h2>
<div class="sidebar-module">
  <form class="search" method="GET" action="https://www.google.com.hk/search">
    <input type="text" name="q" class="search-query" placeholder=" Search on Google">
    <input type="hidden" name="ie" value="utf-8">
    <input type="submit" name="sa" value="Search" />
  </form><br>
  <input type="text" class="search-field" placeholder=" Search This Site">
  <div class="search-results"></div>
</div>



    </div>
  </div>
<hr><p class="text-center">This Site was built by Jin Yang, generated with Jekyll, and hosted on GitHub Pages<br/> &copy;2013-2019 &ndash; Jin Yang</p><div class="footer-logo"></div>

</div>
</body>
</html>
